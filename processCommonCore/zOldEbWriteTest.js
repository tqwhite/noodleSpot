var qs=require('qs');
var request = require("request");
var qtools=require('qtools');
request=request.defaults({jar: true})

var payload={"Data":{"UserName":"coordinator","Password":"test"},"Date":"2014-03-03T22:10:19.511Z"};


var jsonPayload=JSON.stringify(payload);
var wrappedPayload={postData:jsonPayload};

request.post({
	headers:{
		'Content-Type' : 'application/x-www-form-urlencoded'
    },
	//uri: "http://localhost/test.php",
	uri: "http://expressbook.local/data/UserState/Login",
	form:    wrappedPayload
}, function(error, response, body) {
console.log('login response.statusMessage='+response.statusMessage+'\n');
 // stepTwo()
});

var stepTwo=function(){
var payload={"Data":{"RefId":"5ddb2c37-7644-4526-8bc5-91586ef27456"},"Date":"2014-03-04T01:37:50.794Z"};

var payload={"Data":{"RefId":"5ddb2c37-7644-4526-8bc5-91586ef27456","Realm":[{"$type":"DatabaseModel.Models.Realm","RefId":"d277510a-f478-4234-85f0-9c119373bca6","Version":3,"Title":"Basic Learning Objectives","AbbrevTitle":"realm","Description":"","DepthCount":0,"DepthNames":[],"IsDetailed":true,"Standards":[{"$type":"DatabaseModel.Models.Standard","RefId":"d8db8e44-a7ba-433d-961a-40581b238e9e","Version":3,"Title":"Art","AbbrevTitle":"art","Description":"","SequenceNum":1000,"ImportCode":null,"ExportCode":"","MarkScale":null,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}],"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1}],"IsDetailed":true,"ParentStandard":null,"Specialties":[{"$type":"DatabaseModel.Models.Specialty","RefId":"789d7d35-fb09-488d-abf4-5faa604112ab","Version":1}],"Components":[],"Activities":[{"$type":"DatabaseModel.Models.Activity","RefId":"e3d97919-96d0-471a-94ec-d703a248f48e","Version":1,"Title":"Doodling","AbbrevTitle":"doodle","Description":"","SequenceNum":1000,"ImportCode":"","ExportCode":"","IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"d8db8e44-a7ba-433d-961a-40581b238e9e","Version":3},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}]},{"$type":"DatabaseModel.Models.Activity","RefId":"2861a76c-40cb-4ed5-9b77-3fbd1a5f45d3","Version":1,"Title":"Paing","AbbrevTitle":"paint","Description":"","SequenceNum":2000,"ImportCode":"","ExportCode":"","IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"d8db8e44-a7ba-433d-961a-40581b238e9e","Version":3},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}]},{"$type":"DatabaseModel.Models.Activity","AbbrevTitle":"sketch","Activities":[],"Applicability":[{"RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7"},{"RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560"}],"CompulsionLevel":{"RefId":"37f28d0b-d763-4585-a2ff-13381d7a5cbc"},"Description":"","IsDetailed":true,"MarkScale":{"RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc"},"RefId":"411edf49-2403-4181-b49a-d1e66fd333d3","SequenceNum":1000,"Standard":{},"Terms":[{"RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a"},{"RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816"},{"RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb"}],"Title":"Hi MIKE","CanDelete":true,"CreateNew":false,"_dirty":1,"_new":false,"_fresh":2,"ExportCode":"","ImportCode":"","SuppressDisplay":false}],"SuppressDisplay":false,"InReportCard":false,"_dirty":2},{"$type":"DatabaseModel.Models.Standard","RefId":"83d5681f-07c7-4301-970e-3a765ec28c01","Version":2,"Title":"Language","AbbrevTitle":"","Description":"","SequenceNum":1000,"ImportCode":null,"ExportCode":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1}],"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1}],"IsDetailed":true,"ParentStandard":null,"Specialties":[{"$type":"DatabaseModel.Models.Specialty","RefId":"04acf1b9-5b34-4d22-9f1b-e8dfea6a35c5","Version":1},{"$type":"DatabaseModel.Models.Specialty","RefId":"342c5412-8e09-4d2d-b11a-f76a3ead9a93","Version":1}],"Components":[],"Activities":[{"$type":"DatabaseModel.Models.Activity","RefId":"8c7a7cfd-ad46-49e4-a485-2b13bf5f8530","Version":2,"Title":"Reading","AbbrevTitle":"read","Description":"","SequenceNum":1000,"ImportCode":"","ExportCode":null,"IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"83d5681f-07c7-4301-970e-3a765ec28c01","Version":2},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1}]},{"$type":"DatabaseModel.Models.Activity","RefId":"4d9cdaf1-b558-488d-a485-7e0453a3284e","Version":2,"Title":"Writing","AbbrevTitle":"write","Description":"","SequenceNum":2000,"ImportCode":"","ExportCode":null,"IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"83d5681f-07c7-4301-970e-3a765ec28c01","Version":2},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1}]}],"SuppressDisplay":false,"InReportCard":false},{"$type":"DatabaseModel.Models.Standard","RefId":"cc5e5970-49e2-42d9-8584-dad444d3755f","Version":2,"Title":"Mathematics","AbbrevTitle":"math","Description":"","SequenceNum":1000,"ImportCode":null,"ExportCode":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}],"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1}],"IsDetailed":true,"ParentStandard":null,"Specialties":[{"$type":"DatabaseModel.Models.Specialty","RefId":"04acf1b9-5b34-4d22-9f1b-e8dfea6a35c5","Version":1},{"$type":"DatabaseModel.Models.Specialty","RefId":"dc4b4efd-14d7-4ee9-b962-8a219e4905cc","Version":1}],"Components":[],"Activities":[{"$type":"DatabaseModel.Models.Activity","RefId":"77df2865-4e15-427c-89e6-80b125a562ec","Version":1,"Title":"Addition","AbbrevTitle":"add","Description":"","SequenceNum":1000,"ImportCode":"","ExportCode":null,"IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"cc5e5970-49e2-42d9-8584-dad444d3755f","Version":2},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}]},{"$type":"DatabaseModel.Models.Activity","RefId":"74981ea2-413a-4d53-ab05-007323423d64","Version":1,"Title":"Subtraction","AbbrevTitle":"subtract","Description":"","SequenceNum":2000,"ImportCode":"","ExportCode":null,"IsDetailed":true,"OwnerRosmat":{"$type":"DatabaseModel.Models.Rosmat","RefId":"7af8cb85-44f1-4210-9cc1-52c11a1f4c8b","Version":2},"Standard":{"$type":"DatabaseModel.Models.Standard","RefId":"cc5e5970-49e2-42d9-8584-dad444d3755f","Version":2},"CompulsionLevel":null,"MarkScale":{"$type":"DatabaseModel.Models.MarkScale","RefId":"54cf207d-c4bc-4d01-a763-c02f13de92bc","Version":2},"Terms":[{"$type":"DatabaseModel.Models.Term","RefId":"042b7f04-3a82-4c35-b928-e4f134b7f35a","Version":1,"Title":"Fall","AbbrevTitle":"fall","SequenceNum":10,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"8fe7914b-0fe9-4d2d-af1f-a0de7be8b816","Version":1,"Title":"Winter","AbbrevTitle":"winter","SequenceNum":20,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false},{"$type":"DatabaseModel.Models.Term","RefId":"f48d9c47-3a04-4402-8c1d-af4414e077eb","Version":1,"Title":"Spring","AbbrevTitle":"spring","SequenceNum":30,"SuppressDisplay":false,"YearLongTerm":false,"IsDetailed":true,"Mapping":[],"AdminNotes":null,"CanDelete":false}],"SuppressDisplay":false,"Applicability":[{"$type":"DatabaseModel.Models.GradeLevel","RefId":"9acf0f03-d28a-44de-b212-b6984c02ead7","Version":1},{"$type":"DatabaseModel.Models.GradeLevel","RefId":"7f1df983-3fc0-4264-9c5f-0fb7add9f560","Version":1}]}],"SuppressDisplay":false,"InReportCard":false}]}]}}
var jsonPayload=JSON.stringify(payload);
var wrappedPayload={postData:jsonPayload};
console.log(JSON.parse(wrappedPayload.postData));

request.post({
	headers:{
		'Content-Type' : 'application/x-www-form-urlencoded'
    },
	//uri: "http://localhost/test.php",
	uri: "http://expressbook.local/data/District/SaveRealms",
	form:    wrappedPayload
}, function(error, response, body) {
  console.log(body);
});
}

//	body:    "%7B%22Data%22%3A%7B%22UserName%22%3A%22coordinator%22%2C%22Password%22%3A%22test%22%7D%2C%22Date%22%3A%222014-03-03T21%3A35%3A09.050Z%22%7D"
//correct appearance in visual studio
//"{\"Data\":{\"UserName\":\"coordinator\",\"Password\":\"test\"},\"Date\":\"2014-03-03T23:09:49.395Z\"}"